
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import org.apache.log4j.Logger;
public class DBConnectionMgr {
    Logger logger = Logger.getLogger(DBConnectionMgr.class);
    private final String driver = "oracle.jdbc.driver.OracleDriver";
    private final String _user = "hr";
    private final String _passwd = "tiger";
    private final String url = "jdbc:oracle:thin:@localhost:1521:orcl11";
    public static DBConnectionMgr getInstance() {
       DBConnectionMgr dbMgr = null;
       if(dbMgr == null) {
          dbMgr = new DBConnectionMgr();
       }
       return dbMgr;
    }
    public Connection getConnection() {
       Connection con = null;
       try {
          Class.forName(driver);
          con = DriverManager.getConnection(url, _user, _passwd);
       } catch (Exception e) {
          // TODO: handle exception
          logger.info("=======================================" + e.toString());
          e.printStackTrace();
       }

       return con;
    }

    public static void freeConnection(Connection con, Statement stmt, ResultSet rs) {
       if (rs != null) {
          try {
             rs.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
       if (stmt != null) {
          try {
             stmt.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
       if (con != null) {
          try {
             con.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
    }

    public static void freeConnection(Connection con, PreparedStatement pstmt, ResultSet rs) {
       if (rs != null) {
          try {
             rs.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
       if (pstmt != null) {
          try {
             pstmt.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
       if (con != null) {
          try {
             con.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
    }

    public static void freeConnection(Connection con, Statement stmt) {
       if (stmt != null) {
          try {
             stmt.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
       if (con != null) {
          try {
             con.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
    }

    public static void freeConnection(Connection con, PreparedStatement pstmt) {
       if (pstmt != null) {
          try {
             pstmt.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
       if (con != null) {
          try {
             con.close();
          } catch (SQLException e) {
             e.printStackTrace();
          }
       }
    }
}
